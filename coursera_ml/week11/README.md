# APPLICATION EXAMPLE: PHOTO OCR

## Photo OCR

#### Problem Description and Pipeline

* Photo OCR(Photo Optical Character Recognition)は撮った写真の中のテキストをコンピュータにどうやって読ませるか

* 盲目の人を助けたりカーナビで使うようなアプリケーション例もある

* Photo OCR パイプライン。これはいくつかの機械学習を使ったコンポーネントが多段になっているシステムを指す
  1. テキスト検出
  2. 文字分割。文を各アルファベットに分割
  3. 文字分類

* パイプラインの各コンポーネントは独立しているので、別のエンジニアで実装することもできる

#### Sliding Windows

* スライディングウィンドウ分類器

* 歩行者検出は固定されたアスペクト比を使うことで検出できる。テキスト検出は異なる行でアスペクト比は異なるので少しむずかしい

* 1000以上のトレーニングセットでニューラルネットワークのような学習アルゴリズムをトレーニングして、歩行者が含まれているかを分類する

* 矩形のパッチをとってその画像に歩行者がいるかで分類。終わったらシフト(ステップサイズ/ストライド)を画像全体に繰り返す。これが終わったらもっと大きなパッチをとって再度シフト。パッチのサイズでもいくつか繰り返して最終的に歩行者を得る

* テキスト検出
  * テキストの可能性が高いと白、低いと黒で表示させる
  *  周りも白ならその付近の領域を白く塗って拡大する。白のピクセルの一定の距離内に白のピクセルがあれば白く塗る
  * アスペクト比チェック(テキストは幅より高さが大きい)

* 文字分類
  * ニューラルネットワークなどの教師あり学習アルゴリズムを使ってアルファベットに分類

* 文字分割
  * 文字を縦にに区切り線が画像の中心に来るようなサンプルがy=1, それ以外がy=0
  * これは1次元のスライディングウィンドウとなる

#### Getting Lots of Data an Artificial Data

* 人工データ合成でトレーニングセット用の大量のデータを得る
  1. ゼロから新しいデータを作り出す
  2.  既に少量のラベルつきトレーニングセットを持っていたらそのトレーニングセットをより大きなトレーニングセットに変える

1 ゼロから新しいデータを作り出す
 * 別々のフォントから文字を取り出して、別々のランダムな背景にペーストする

![Artificial data synthesis for photo OCR](https://github.com/wkodate/CourseraML/blob/master/week11/images/week11-1-1.png)

2 既に少量のラベルつきトレーニングセットを持っていたらそのトレーニングセットをより大きなトレーニングセットに変える
  * 格子状の線を引いて人工的な歪みを導入する

![Synthesizing data by introducing distortions](https://github.com/wkodate/CourseraML/blob/master/week11/images/week11-1-2.png)

* 音声認識で手本を追加する際も、ネットワーク不良や音声に雑音や機械的な音が入ったような手本を使うとトレーニングセットを増やす音ができる

* 画像の歪みは実際に起こり得るような画像にすべき

* 僅かなランダムノイズでは、画像に大きな変化はないので余り役に立たない

1. 拡張をする前に、低バイアス分類器であるかを学習曲線で確認する。低バイアスでなければ、フィーチャーの数を増やしたり、ニューラルネットワークの隠れ層の数を増やして低バイアスの分類器にする
2. 現在持っているデータセットの10倍を得るのにどれだけ時間がかかるか考える。おそらく2~3日の短い時間でデータは作れる
  * 人口データの合成
  * データ収集とラベル付けを自分で行う
  * クラウドソーシング(例えばAmazon Mechanical Turk)

#### Ceiling Analysis: What Part of the Pipeline to Work on Next

* シーリング分析は機械学習パイプラインのどの部分を改善すればよいかを教えてくれる

* システム全体の正確さを出し、パイプラインの最初に精度100%の入力を流し、再度システム全体の正確さを出す。パイプラインの次も同様のことを行い、各コンポーネントでの正確性の上昇率を見る。上昇率の高いコンポーネントが改善の余地があるのでリソースを費やすべき

* 人力でテストセットの画像のどこにテキストがあるかをラベル付けして、それを次のパイプラインに食わせる

![Estimating the errors due to each components(ceiling analysis)](https://github.com/wkodate/CourseraML/blob/master/week11/images/week11-1-3.png)

* 画像の顔認識のシーリング分析の例
  * パイプライン
    1. 画像から背景を除去
    2. 顔認識
      * 目の認識
      * 鼻の認識
      * 口の認識
    3. ロジスティック回帰の分類器のフィーチャーに上記を使う
    4. ラベル付け
  * 各コンポーネントの前半から精度100%のデータを入力することによって、各コンポーネントの正確性の上昇率を調べる

![Another ceiling analysis example](https://github.com/wkodate/CourseraML/blob/master/week11/images/week11-1-4.png)

## Conclusion

#### Summary and Thank You

* 教師あり学習
  * 線形回帰
  * ロジスティック回帰
  * ニューラルネットワーク
  * SVM
* 教師なし学習
  * k-means
  * PCA
  * アノマリー検出
* 特別なアプリケーション/特別なトピックス
  * レコメンダーシステム
  * 大規模機械学習
* 機械学習システムを構築するためのアドバイス
  * バイアス/バリアンス
  * 正規化
  * 機械学習アルゴリズムの開発で何に時間を費やすべきかの決定
  * 機械学習アルゴリズムの評価
  * 学習曲線
  * エラー解析
  * シーリング分析

